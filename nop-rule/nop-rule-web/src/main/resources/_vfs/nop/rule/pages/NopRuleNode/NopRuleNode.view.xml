<?xml version="1.0" encoding="UTF-8" ?>
<view x:extends="_gen/_NopRuleNode.view.xml" x:schema="/nop/schema/xui/xview.xdef"
      xmlns:x="/nop/schema/xdsl.xdef" xmlns:c="c" xmlns:web="web">

    <x:config>
        <c:import from="/nop/web/xlib/web.xlib"/>
    </x:config>

    <grids>
        <grid id="list"/>
        <grid id="pick-list"/>

        <!-- 可以在当前视图文件中引用其他对象的objMeta定义grid -->
        <grid id="outputGrid" >
            <objMeta>/nop/rule/model/NopRuleOutputValue/NopRuleOutputValue.xmeta</objMeta>
            <cols>
                <col id="name"/>
                <col id="valueExpr"/>
            </cols>
        </grid>
    </grids>

    <forms>
        <form id="view">
            <cells>
                <cell id="predicate" depends="predicateLabel">
                    <gen-control>
                        <static name="predicateLabel"/>
                    </gen-control>
                </cell>
                <cell id="outputs">
                   <view grid="outputGrid"/>
                </cell>
            </cells>
        </form>

        <form id="edit">
            <cells>
                <cell id="predicate">
                    <gen-control>
                        <condition-builder embed="@:false"
                                           title="@i18n:common.conditionConfig|条件配置"
                                           source="@query:NopRuleDefinition__getConditionFields?ruleId=$ruleId"/>
                    </gen-control>
                </cell>

                <cell id="outputs">
                    <view grid="outputGrid" />
                </cell>
            </cells>
        </form>
    </forms>

    <pages>
        <crud name="main"/>
        <picker name="picker"/>

        <simple name="add-child">
            <!-- 一旦设置data就不会继承外部环境中的数据，因此这里需要手工传递一下 -->
            <data>
                <parentId>$id</parentId>
                <ruleId>$ruleId</ruleId>
                <ruleDefinition>
                    <displayName>$ruleDefinition.displayName</displayName>
                </ruleDefinition>
            </data>
        </simple>
    </pages>
</view>