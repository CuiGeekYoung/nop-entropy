# 如何为Spring和Mybatis增加可逆计算支持

Mybatis所管理的SQL语句存放在XML配置文件中，号称是可以在不修改源码的情况下通过配置调整来定制数据库访问逻辑，比如适配不同的数据库方言等。
但在实际使用中，如果XML文件已经被打包到Jar包中，那么即使是进行单个SQL语句的定制也必须要复制整个配置文件，这明显是设计上的一种缺陷。
可逆计算理论为所有的DSL语言提供了统一的差量化定制语法。借助于Nop平台的基础设施，我们只需要补充少量代码，拦截Mybatis的配置文件加载过程，就可以为
Mybatis框架引入可逆计算支持，实现细粒度的差量化定制。如法炮制，同样的方法还可以被应用于Spring框架的改造。

# Mybatis的Delta定制

Mybatis内置了一个简易的分解、聚合机制：多个XML文件可以具有同样的namespace，从而聚合为一个统一的Mapper接口。

在模型驱动的开发模式下，我们一般会根据模型中自动生成一组增删改查的SQL语句，把它们存放在单独的Mapper文件中，通过一个标准的BaseMapper接口来映射这些SQL语句。
然后再生成一个BaseMapper的派生接口，手工编写的SQL语句可以存放在单独的XML文件中。例如：

1. 代码生成 [_SysUser.mapper.xml]()文件 